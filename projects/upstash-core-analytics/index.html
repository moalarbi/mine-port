<!DOCTYPE html><html lang="ar" dir="rtl" class="__variable_368abf __variable_364a63"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/moalarbi-portfolio1/_next/static/css/bf3b67282ae622e4.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/moalarbi-portfolio1/_next/static/css/ccb12de4c58e29a3.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/moalarbi-portfolio1/_next/static/chunks/webpack-7aede6d79f56a0c2.js" crossorigin=""/><script src="/moalarbi-portfolio1/_next/static/chunks/e0d065d3-7c12bdfa4e9aac01.js" async="" crossorigin=""></script><script src="/moalarbi-portfolio1/_next/static/chunks/213-ebd7edce7bd8f80d.js" async="" crossorigin=""></script><script src="/moalarbi-portfolio1/_next/static/chunks/main-app-3b3e796a95e38971.js" async="" crossorigin=""></script><script src="/moalarbi-portfolio1/_next/static/chunks/app/layout-854e0d098fab093b.js" async=""></script><script src="/moalarbi-portfolio1/_next/static/chunks/627-2305de044010e1d9.js" async=""></script><script src="/moalarbi-portfolio1/_next/static/chunks/428-b3b3993ff492f857.js" async=""></script><script src="/moalarbi-portfolio1/_next/static/chunks/app/projects/%5Bslug%5D/page-792858a32482a6f2.js" async=""></script><title>moalarbi.com</title><meta name="description" content="Co-founder of unkey.dev and founder of planetfall.io"/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><meta property="og:title" content="moalarbi.com"/><meta property="og:description" content="Co-founder of unkey.dev and founder of planetfall.io"/><meta property="og:url" content="https://moalarbi.com/"/><meta property="og:site_name" content="moalarbi.com"/><meta property="og:locale" content="en-US"/><meta property="og:image" content="https://moalarbi.com/og.png"/><meta property="og:image:width" content="1920"/><meta property="og:image:height" content="1080"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Chronark"/><meta name="twitter:description" content="Co-founder of unkey.dev and founder of planetfall.io"/><meta name="twitter:image" content="https://moalarbi.com/og.png"/><meta name="twitter:image:width" content="1920"/><meta name="twitter:image:height" content="1080"/><link rel="shortcut icon" href="/favicon.png"/><script src="/moalarbi-portfolio1/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="bg-black font-ibm "><div class="relative min-h-screen bg-gradient-to-tl from-zinc-900 via-zinc-400/10 to-zinc-900 "><div dir="rtl" lang="ar" class="bg-zinc-50 min-h-screen text-right"><header class="relative isolate overflow-hidden bg-gradient-to-tl from-black via-zinc-900 to-black"><div class="fixed inset-x-0 top-0 z-50 backdrop-blur lg:backdrop-blur-none duration-200 border-b lg:bg-transparent bg-zinc-900/0 border-transparent"><div class="container flex flex-row-reverse items-center justify-between p-6 mx-auto"><div class="flex justify-between gap-8"><span title="View counter for this page" class="duration-200 hover:font-medium flex items-center gap-1  text-zinc-400 hover:text-zinc-100 "><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"></path><circle cx="12" cy="12" r="3"></circle></svg> <!-- -->1.2K</span><a target="_blank" href="https://twitter.com/chronark_"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 "><path d="M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z"></path></svg></a><a target="_blank" href="https://github.com/chronark"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 "><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a></div><a class="duration-200 hover:font-medium  text-zinc-400 hover:text-zinc-100 " href="/moalarbi-portfolio1/projects/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6 "><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg></a></div></div><div class="container mx-auto relative isolate overflow-hidden  py-24 sm:py-32"><div class="mx-auto max-w-7xl px-6 lg:px-8 text-center flex flex-col items-center"><div class="mx-auto max-w-2xl lg:mx-0"><h1 class="text-4xl font-bold tracking-tight text-white sm:text-6xl font-display">Upstash Core Analytics</h1><p class="mt-6 text-lg leading-8 text-zinc-300">Low level utilities to build analytics tools on top of Redis.</p></div><div class="mx-auto mt-10 max-w-2xl lg:mx-0 lg:max-w-none"><div class="grid grid-cols-1 gap-y-6 gap-x-8 text-base font-semibold leading-7 text-white sm:grid-cols-2 md:flex lg:gap-x-10"><a target="_blank" href="https://github.com/upstash/core-analytics">GitHub<!-- --> <span aria-hidden="true">→</span></a><a target="_blank" href="https://console.upstash.com/ratelimit">Website<!-- --> <span aria-hidden="true">→</span></a></div></div></div></div></header><article class="px-4 py-12 mx-auto prose prose-zinc prose-quoteless"><div class="mdx"><p class="leading-7 [&amp;:not(:first-child)]:mt-6">This library offers some low level building blocks to record and analyze custom events in Redis.
It&#x27;s main purpose is to provide a simple way to record and query events in Redis without having to worry about the underlying data structure so we can build more advanced analytics features on top of it.</p>
<h2 class="mt-10 scroll-m-20 border-b border-b-zinc-800 pb-1 text-3xl font-semibold tracking-tight first:mt-0" id="quickstart"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#quickstart"><span class="icon icon-link"></span></a>Quickstart</h2>
<ol class="my-6 ml-6 list-decimal">
<li class="mt-2">Create a redis database</li>
</ol>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">Go to <a class="font-medium text-zinc-900 underline underline-offset-4" href="https://console.upstash.com/redis">console.upstash.com/redis</a> and create
a new global database.</p>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">After creating the db, copy the <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">UPSTASH_REDIS_REST_URL</code> and <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">UPSTASH_REDIS_REST_TOKEN</code> to your <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">.env</code> file.</p>
<ol class="my-6 ml-6 list-decimal" start="3">
<li class="mt-2">Install <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">@upstash/analytics</code> in your project</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="bash" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="bash" data-theme="default" style="display:grid"><span data-line=""><span style="color:#B392F0">npm</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">install</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">@upstash/analytics</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">@upstash/redis</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="4">
<li class="mt-2">Create an analytics client</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="ts" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="ts" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { Analytyics } </span><span style="color:#F97583">from</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">&quot;@upstash/analytics&quot;</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { Redis } </span><span style="color:#F97583">from</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">&quot;@upstash/redis&quot;</span><span style="color:#E1E4E8">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">analytics</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">new</span><span style="color:#E1E4E8"> </span><span style="color:#B392F0">Analytics</span><span style="color:#E1E4E8">({</span></span>
<span data-line=""><span style="color:#E1E4E8">  redis: Redis.</span><span style="color:#B392F0">fromEnv</span><span style="color:#E1E4E8">(),</span></span>
<span data-line=""><span style="color:#E1E4E8">  window: </span><span style="color:#9ECBFF">&quot;1d&quot;</span><span style="color:#E1E4E8">,</span></span>
<span data-line=""><span style="color:#E1E4E8">});</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="5">
<li class="mt-2">Ingest some events</li>
</ol>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">An event consists of a <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">time</code> field and any additional key-value pairs that you can use to record any information you want.</p>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="ts" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="ts" data-theme="default" style="display:grid"><span data-line=""><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">event</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> {</span></span>
<span data-line=""><span style="color:#E1E4E8">  time: Date.</span><span style="color:#B392F0">now</span><span style="color:#E1E4E8">() </span><span style="color:#6A737D">// optional (default: Date.now())</span></span>
<span data-line=""><span style="color:#E1E4E8">  userId: </span><span style="color:#9ECBFF">&quot;chronark&quot;</span><span style="color:#E1E4E8">,</span></span>
<span data-line=""><span style="color:#E1E4E8">  page: </span><span style="color:#9ECBFF">&quot;/auth/login&quot;</span><span style="color:#E1E4E8">,</span></span>
<span data-line=""><span style="color:#E1E4E8">  country: </span><span style="color:#9ECBFF">&quot;DE&quot;</span><span style="color:#E1E4E8">,</span></span>
<span data-line=""><span style="color:#E1E4E8">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#F97583">await</span><span style="color:#E1E4E8"> analytics.</span><span style="color:#B392F0">ingest</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;pageviews&quot;</span><span style="color:#E1E4E8">, event);</span></span></code></pre></div>
<ol class="my-6 ml-6 list-decimal" start="4">
<li class="mt-2">Query your events</li>
</ol>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="ts" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="ts" data-theme="default" style="display:grid"><span data-line=""> </span>
<span data-line=""><span style="color:#F97583">const</span><span style="color:#E1E4E8"> </span><span style="color:#79B8FF">result</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> </span><span style="color:#F97583">await</span><span style="color:#E1E4E8"> analytics.</span><span style="color:#B392F0">query</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">&quot;pageviews&quot;</span><span style="color:#E1E4E8">);</span></span>
<span data-line=""> </span></code></pre></div>
<h2 class="mt-10 scroll-m-20 border-b border-b-zinc-800 pb-1 text-3xl font-semibold tracking-tight first:mt-0" id="development"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#development"><span class="icon icon-link"></span></a>Development</h2>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">This project uses <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">pnpm</code> for dependency management.</p>
<h4 class="mt-8 scroll-m-20 text-xl font-semibold tracking-tight" id="install-dependencies"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#install-dependencies"><span class="icon icon-link"></span></a>Install dependencies</h4>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="bash" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="bash" data-theme="default" style="display:grid"><span data-line=""><span style="color:#B392F0">pnpm</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">install</span></span></code></pre></div>
<h4 class="mt-8 scroll-m-20 text-xl font-semibold tracking-tight" id="build"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#build"><span class="icon icon-link"></span></a>Build</h4>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="bash" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="bash" data-theme="default" style="display:grid"><span data-line=""><span style="color:#B392F0">pnpm</span><span style="color:#E1E4E8"> </span><span style="color:#9ECBFF">build</span></span></code></pre></div>
<h2 class="mt-10 scroll-m-20 border-b border-b-zinc-800 pb-1 text-3xl font-semibold tracking-tight first:mt-0" id="database-schema"><a class="font-medium text-zinc-900 underline underline-offset-4 subheading-anchor" aria-label="Link to section" href="#database-schema"><span class="icon icon-link"></span></a>Database Schema</h2>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">All metrics are stored in Redis <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">Hash</code> data types and sharded into buckets based on the <code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">window</code> option.</p>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="" data-theme="default" style="display:grid"><span data-line=""><span style="color:#e1e4e8">@upstash/analytics:{TABLE}:{TIMESTAMP}</span></span></code></pre></div>
<ul class="my-6 ml-6 list-disc">
<li class="mt-2"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">TABLE</code> is a namespace to group events together. ie for managing multiple projects int a single database</li>
<li class="mt-2"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600">TIMESTAMP</code> is the starting timestamp of each window</li>
</ul>
<p class="leading-7 [&amp;:not(:first-child)]:mt-6">The field of each hash is a serialized JSON object with the user&#x27;s event data and the value is the number of times this event has been recorded.</p>
<div data-rehype-pretty-code-fragment=""><pre class="mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark" style="background-color:#24292e" tabindex="0" data-language="json" data-theme="default"><code class="relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600" data-language="json" data-theme="default" style="display:grid"><span data-line=""><span style="color:#E1E4E8">{</span></span>
<span data-line=""><span style="color:#E1E4E8">  </span><span style="color:#FDAEB7;font-style:italic">&#x27;{</span><span style="color:#79B8FF">&quot;page&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;/auth/login&quot;</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">&quot;country&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;DE&quot;</span><span style="color:#E1E4E8">}&#x27;: </span><span style="color:#79B8FF">5</span><span style="color:#E1E4E8">,</span></span>
<span data-line=""><span style="color:#E1E4E8">  &#x27;{</span><span style="color:#79B8FF">&quot;page&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;/auth/login&quot;</span><span style="color:#E1E4E8">,</span><span style="color:#79B8FF">&quot;country&quot;</span><span style="color:#E1E4E8">: </span><span style="color:#9ECBFF">&quot;US&quot;</span><span style="color:#E1E4E8">}&#x27;: </span><span style="color:#79B8FF">2</span></span>
<span data-line=""><span style="color:#E1E4E8">}</span></span></code></pre></div></div></article></div></div><script src="/moalarbi-portfolio1/_next/static/chunks/webpack-7aede6d79f56a0c2.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/moalarbi-portfolio1/_next/static/css/bf3b67282ae622e4.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/moalarbi-portfolio1/_next/static/css/ccb12de4c58e29a3.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"4:I[7632,[],\"\"]\n6:I[2073,[],\"\"]\n7:I[4256,[\"185\",\"static/chunks/app/layout-854e0d098fab093b.js\"],\"Analytics\"]\n8:I[1442,[],\"\"]\n9:I[8733,[],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/moalarbi-portfolio1/_next/static/css/bf3b67282ae622e4.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"jHFRI1hbc4sPCTkgfETlV\",\"assetPrefix\":\"/moalarbi-portfolio1\",\"initialCanonicalUrl\":\"/projects/upstash-core-analytics/\",\"initialTree\":[\"\",{\"children\":[\"projects\",{\"children\":[[\"slug\",\"upstash-core-analytics\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"upstash-core-analytics\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L5\"],\"globalErrorComponent\":\"$6\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"ar\",\"dir\":\"rtl\",\"className\":\"__variable_368abf __variable_364a63\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"$L7\",null,{}]}],[\"$\",\"body\",null,{\"className\":\"bg-black font-ibm \",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"childProp\":{\"current\":[null,[\"$\",\"div\",null,{\"className\":\"relative min-h-screen bg-gradient-to-tl from-zinc-900 via-zinc-400/10 to-zinc-900 \",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"projects\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"projects\",\"children\",[\"slug\",\"upstash-core-analytics\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$La\",\"$Lb\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"upstash-core-analytics\\\"}\"},\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/moalarbi-portfolio1/_next/static/css/ccb12de4c58e29a3.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}],\"segment\":[\"slug\",\"upstash-core-analytics\",\"d\"]},\"styles\":[]}]}],null],\"segment\":\"projects\"},\"styles\":[]}]}]]}],null]}]]\n"])</script><script>self.__next_f.push([1,"c:I[9762,[\"627\",\"static/chunks/627-2305de044010e1d9.js\",\"428\",\"static/chunks/428-b3b3993ff492f857.js\",\"101\",\"static/chunks/app/projects/%5Bslug%5D/page-792858a32482a6f2.js\"],\"Header\"]\nf:I[428,[\"627\",\"static/chunks/627-2305de044010e1d9.js\",\"428\",\"static/chunks/428-b3b3993ff492f857.js\",\"101\",\"static/chunks/app/projects/%5Bslug%5D/page-792858a32482a6f2.js\"],\"\"]\nd:T809,"])</script><script>self.__next_f.push([1,"\n\nThis library offers some low level building blocks to record and analyze custom events in Redis.\nIt's main purpose is to provide a simple way to record and query events in Redis without having to worry about the underlying data structure so we can build more advanced analytics features on top of it.\n\n## Quickstart\n\n\n1. Create a redis database\n\nGo to [console.upstash.com/redis](https://console.upstash.com/redis) and create\na new global database.\n\nAfter creating the db, copy the `UPSTASH_REDIS_REST_URL` and `UPSTASH_REDIS_REST_TOKEN` to your `.env` file.\n\n3. Install `@upstash/analytics` in your project\n\n```bash\nnpm install @upstash/analytics @upstash/redis\n```\n\n4. Create an analytics client\n\n```ts\nimport { Analytyics } from \"@upstash/analytics\";\nimport { Redis } from \"@upstash/redis\";\n\nconst analytics = new Analytics({\n  redis: Redis.fromEnv(),\n  window: \"1d\",\n});\n```\n\n\n5. Ingest some events\n\nAn event consists of a `time` field and any additional key-value pairs that you can use to record any information you want.\n\n```ts\nconst event = {\n  time: Date.now() // optional (default: Date.now())\n  userId: \"chronark\",\n  page: \"/auth/login\",\n  country: \"DE\",\n}\n\nawait analytics.ingest(\"pageviews\", event);\n```\n\n4. Query your events\n\n```ts\n\nconst result = await analytics.query(\"pageviews\");\n\n```\n\n## Development\n\nThis project uses `pnpm` for dependency management.\n\n#### Install dependencies\n\n```bash\npnpm install\n```\n\n#### Build\n\n```bash\npnpm build\n```\n\n\n## Database Schema\n\nAll metrics are stored in Redis `Hash` data types and sharded into buckets based on the `window` option.\n```\n@upstash/analytics:{TABLE}:{TIMESTAMP}\n```\n- `TABLE` is a namespace to group events together. ie for managing multiple projects int a single database\n- `TIMESTAMP` is the starting timestamp of each window\n\nThe field of each hash is a serialized JSON object with the user's event data and the value is the number of times this event has been recorded.\n\n```json\n{\n  '{\"page\": \"/auth/login\",\"country\": \"DE\"}': 5,\n  '{\"page\": \"/auth/login\",\"country\": \"US\"}': 2\n}\n```\n"])</script><script>self.__next_f.push([1,"e:T3aac,"])</script><script>self.__next_f.push([1,"var Component=(()=\u003e{var h=Object.create;var r=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var E=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var g=(l,e)=\u003e()=\u003e(e||l((e={exports:{}}).exports,e),e.exports),m=(l,e)=\u003e{for(var a in e)r(l,a,{get:e[a],enumerable:!0})},c=(l,e,a,t)=\u003e{if(e\u0026\u0026typeof e==\"object\"||typeof e==\"function\")for(let s of E(e))!u.call(l,s)\u0026\u0026s!==a\u0026\u0026r(l,s,{get:()=\u003ee[s],enumerable:!(t=p(e,s))||t.enumerable});return l};var F=(l,e,a)=\u003e(a=l!=null?h(y(l)):{},c(e||!l||!l.__esModule?r(a,\"default\",{value:l,enumerable:!0}):a,l)),b=l=\u003ec(r({},\"__esModule\",{value:!0}),l);var i=g((w,d)=\u003e{d.exports=_jsx_runtime});var k={};m(k,{default:()=\u003ev,frontmatter:()=\u003ef});var n=F(i()),f={title:\"Upstash Core Analytics\",description:\"Low level utilities to build analytics tools on top of Redis.\",date:\"2023-02-13\",url:\"https://console.upstash.com/ratelimit\",repository:\"upstash/core-analytics\",published:!0};function o(l){let e=Object.assign({p:\"p\",h2:\"h2\",a:\"a\",span:\"span\",ol:\"ol\",li:\"li\",code:\"code\",div:\"div\",pre:\"pre\",h4:\"h4\",ul:\"ul\"},l.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.p,{children:`This library offers some low level building blocks to record and analyze custom events in Redis.\nIt's main purpose is to provide a simple way to record and query events in Redis without having to worry about the underlying data structure so we can build more advanced analytics features on top of it.`}),`\n`,(0,n.jsxs)(e.h2,{id:\"quickstart\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#quickstart\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Quickstart\"]}),`\n`,(0,n.jsxs)(e.ol,{children:[`\n`,(0,n.jsx)(e.li,{children:\"Create a redis database\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"Go to \",(0,n.jsx)(e.a,{href:\"https://console.upstash.com/redis\",children:\"console.upstash.com/redis\"}),` and create\na new global database.`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"After creating the db, copy the \",(0,n.jsx)(e.code,{children:\"UPSTASH_REDIS_REST_URL\"}),\" and \",(0,n.jsx)(e.code,{children:\"UPSTASH_REDIS_REST_TOKEN\"}),\" to your \",(0,n.jsx)(e.code,{children:\".env\"}),\" file.\"]}),`\n`,(0,n.jsxs)(e.ol,{start:\"3\",children:[`\n`,(0,n.jsxs)(e.li,{children:[\"Install \",(0,n.jsx)(e.code,{children:\"@upstash/analytics\"}),\" in your project\"]}),`\n`]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,n.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"npm\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"install\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"@upstash/analytics\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"@upstash/redis\"})]})})})}),`\n`,(0,n.jsxs)(e.ol,{start:\"4\",children:[`\n`,(0,n.jsx)(e.li,{children:\"Create an analytics client\"}),`\n`]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"ts\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" { Analytyics } \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"@upstash/analytics\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"import\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" { Redis } \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"from\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"@upstash/redis\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"analytics\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"new\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"Analytics\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"({\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  redis: Redis.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"fromEnv\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(),\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  window: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"1d\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"});\"})})]})})}),`\n`,(0,n.jsxs)(e.ol,{start:\"5\",children:[`\n`,(0,n.jsx)(e.li,{children:\"Ingest some events\"}),`\n`]}),`\n`,(0,n.jsxs)(e.p,{children:[\"An event consists of a \",(0,n.jsx)(e.code,{children:\"time\"}),\" field and any additional key-value pairs that you can use to record any information you want.\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"ts\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"event\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" {\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  time: Date.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"now\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"() \"}),(0,n.jsx)(e.span,{style:{color:\"#6A737D\"},children:\"// optional (default: Date.now())\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  userId: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"chronark\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  page: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/auth/login\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  country: \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"DE\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"await\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" analytics.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"ingest\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"pageviews\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\", event);\"})]})]})})}),`\n`,(0,n.jsxs)(e.ol,{start:\"4\",children:[`\n`,(0,n.jsx)(e.li,{children:\"Query your events\"}),`\n`]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"ts\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"ts\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"const\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"result\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"=\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#F97583\"},children:\"await\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" analytics.\"}),(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"query\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"(\"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"pageviews\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\");\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:\" \"})]})})}),`\n`,(0,n.jsxs)(e.h2,{id:\"development\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#development\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Development\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"This project uses \",(0,n.jsx)(e.code,{children:\"pnpm\"}),\" for dependency management.\"]}),`\n`,(0,n.jsxs)(e.h4,{id:\"install-dependencies\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#install-dependencies\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Install dependencies\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,n.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"pnpm\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"install\"})]})})})}),`\n`,(0,n.jsxs)(e.h4,{id:\"build\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#build\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Build\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",children:(0,n.jsx)(e.code,{\"data-language\":\"bash\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#B392F0\"},children:\"pnpm\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\" \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:\"build\"})]})})})}),`\n`,(0,n.jsxs)(e.h2,{id:\"database-schema\",children:[(0,n.jsx)(e.a,{className:\"subheading-anchor\",\"aria-label\":\"Link to section\",href:\"#database-schema\",children:(0,n.jsx)(e.span,{className:\"icon icon-link\"})}),\"Database Schema\"]}),`\n`,(0,n.jsxs)(e.p,{children:[\"All metrics are stored in Redis \",(0,n.jsx)(e.code,{children:\"Hash\"}),\" data types and sharded into buckets based on the \",(0,n.jsx)(e.code,{children:\"window\"}),\" option.\"]}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"\",\"data-theme\":\"default\",children:(0,n.jsx)(e.code,{\"data-language\":\"\",\"data-theme\":\"default\",style:{display:\"grid\"},children:(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#e1e4e8\"},children:\"@upstash/analytics:{TABLE}:{TIMESTAMP}\"})})})})}),`\n`,(0,n.jsxs)(e.ul,{children:[`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"TABLE\"}),\" is a namespace to group events together. ie for managing multiple projects int a single database\"]}),`\n`,(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:\"TIMESTAMP\"}),\" is the starting timestamp of each window\"]}),`\n`]}),`\n`,(0,n.jsx)(e.p,{children:\"The field of each hash is a serialized JSON object with the user's event data and the value is the number of times this event has been recorded.\"}),`\n`,(0,n.jsx)(e.div,{\"data-rehype-pretty-code-fragment\":\"\",children:(0,n.jsx)(e.pre,{className:\"github-dark\",style:{backgroundColor:\"#24292e\"},tabIndex:\"0\",\"data-language\":\"json\",\"data-theme\":\"default\",children:(0,n.jsxs)(e.code,{\"data-language\":\"json\",\"data-theme\":\"default\",style:{display:\"grid\"},children:[(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"{\"})}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  \"}),(0,n.jsx)(e.span,{style:{color:\"#FDAEB7\",fontStyle:\"italic\"},children:\"'{\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:'\"page\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/auth/login\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:'\"country\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"DE\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}': \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"5\"}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"})]}),`\n`,(0,n.jsxs)(e.span,{\"data-line\":\"\",children:[(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"  '{\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:'\"page\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"/auth/login\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\",\"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:'\"country\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,n.jsx)(e.span,{style:{color:\"#9ECBFF\"},children:'\"US\"'}),(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}': \"}),(0,n.jsx)(e.span,{style:{color:\"#79B8FF\"},children:\"2\"})]}),`\n`,(0,n.jsx)(e.span,{\"data-line\":\"\",children:(0,n.jsx)(e.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})})]})}function B(l={}){let{wrapper:e}=l.components||{};return e?(0,n.jsx)(e,Object.assign({},l,{children:(0,n.jsx)(o,l)})):o(l)}var v=B;return b(k);})();\n;return Component;"])</script><script>self.__next_f.push([1,"b:[\"$\",\"div\",null,{\"dir\":\"rtl\",\"lang\":\"ar\",\"className\":\"bg-zinc-50 min-h-screen text-right\",\"children\":[[\"$\",\"$Lc\",null,{\"project\":{\"published\":true,\"title\":\"Upstash Core Analytics\",\"description\":\"Low level utilities to build analytics tools on top of Redis.\",\"date\":\"2023-02-13T00:00:00.000Z\",\"url\":\"https://console.upstash.com/ratelimit\",\"repository\":\"upstash/core-analytics\",\"body\":{\"raw\":\"$d\",\"code\":\"$e\"},\"_id\":\"projects/upstash-core-analytics.mdx\",\"_raw\":{\"sourceFilePath\":\"projects/upstash-core-analytics.mdx\",\"sourceFileName\":\"upstash-core-analytics.mdx\",\"sourceFileDir\":\"projects\",\"contentType\":\"mdx\",\"flattenedPath\":\"projects/upstash-core-analytics\"},\"type\":\"Project\",\"path\":\"/projects/upstash-core-analytics\",\"slug\":\"upstash-core-analytics\"},\"views\":1234}],[\"$\",\"article\",null,{\"className\":\"px-4 py-12 mx-auto prose prose-zinc prose-quoteless\",\"children\":[\"$\",\"div\",null,{\"className\":\"mdx\",\"children\":[[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":\"This library offers some low level building blocks to record and analyze custom events in Redis.\\nIt's main purpose is to provide a simple way to record and query events in Redis without having to worry about the underlying data structure so we can build more advanced analytics features on top of it.\"}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-10 scroll-m-20 border-b border-b-zinc-800 pb-1 text-3xl font-semibold tracking-tight first:mt-0\",\"id\":\"quickstart\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#quickstart\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Quickstart\"]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Create a redis database\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"Go to \",[\"$\",\"$Lf\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4\",\"href\":\"https://console.upstash.com/redis\",\"children\":\"console.upstash.com/redis\"}],\" and create\\na new global database.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"After creating the db, copy the \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"UPSTASH_REDIS_REST_URL\"}],\" and \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"UPSTASH_REDIS_REST_TOKEN\"}],\" to your \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\".env\"}],\" file.\"]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"3\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":[\"Install \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"@upstash/analytics\"}],\" in your project\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"npm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"install\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"@upstash/analytics\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"@upstash/redis\"}]]}]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"4\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Create an analytics client\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"ts\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"ts\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" { Analytyics } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"@upstash/analytics\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"import\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" { Redis } \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"from\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"@upstash/redis\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\";\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"analytics\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"new\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"Analytics\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  redis: Redis.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"fromEnv\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"(),\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  window: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"1d\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"});\"}]}]]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"5\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Ingest some events\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"An event consists of a \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"time\"}],\" field and any additional key-value pairs that you can use to record any information you want.\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"ts\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"ts\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"event\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  time: Date.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"now\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"() \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#6A737D\"},\"children\":\"// optional (default: Date.now())\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  userId: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"chronark\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  page: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"/auth/login\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  country: \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"DE\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" analytics.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"ingest\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"pageviews\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\", event);\"}]]}]]}]}]}],\"\\n\",[\"$\",\"ol\",null,{\"className\":\"my-6 ml-6 list-decimal\",\"start\":\"4\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":\"Query your events\"}],\"\\n\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"ts\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"ts\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"const\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"result\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"=\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#F97583\"},\"children\":\"await\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" analytics.\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"query\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"(\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"pageviews\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\");\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":\" \"}]]}]}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-10 scroll-m-20 border-b border-b-zinc-800 pb-1 text-3xl font-semibold tracking-tight first:mt-0\",\"id\":\"development\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#development\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Development\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"This project uses \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"pnpm\"}],\" for dependency management.\"]}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"mt-8 scroll-m-20 text-xl font-semibold tracking-tight\",\"id\":\"install-dependencies\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#install-dependencies\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Install dependencies\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"pnpm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"install\"}]]}]}]}]}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"mt-8 scroll-m-20 text-xl font-semibold tracking-tight\",\"id\":\"build\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#build\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Build\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"bash\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#B392F0\"},\"children\":\"pnpm\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\" \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"build\"}]]}]}]}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"mt-10 scroll-m-20 border-b border-b-zinc-800 pb-1 text-3xl font-semibold tracking-tight first:mt-0\",\"id\":\"database-schema\",\"children\":[[\"$\",\"$Lf\",null,{\"className\":\"font-medium text-zinc-900 underline underline-offset-4 subheading-anchor\",\"aria-label\":\"Link to section\",\"href\":\"#database-schema\",\"children\":[\"$\",\"span\",null,{\"className\":\"icon icon-link\"}]}],\"Database Schema\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":[\"All metrics are stored in Redis \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"Hash\"}],\" data types and sharded into buckets based on the \",[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"window\"}],\" option.\"]}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#e1e4e8\"},\"children\":\"@upstash/analytics:{TABLE}:{TIMESTAMP}\"}]}]}]}]}],\"\\n\",[\"$\",\"ul\",null,{\"className\":\"my-6 ml-6 list-disc\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":[[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"TABLE\"}],\" is a namespace to group events together. ie for managing multiple projects int a single database\"]}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"mt-2\",\"children\":[[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"children\":\"TIMESTAMP\"}],\" is the starting timestamp of each window\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"leading-7 [\u0026:not(:first-child)]:mt-6\",\"children\":\"The field of each hash is a serialized JSON object with the user's event data and the value is the number of times this event has been recorded.\"}],\"\\n\",[\"$\",\"div\",null,{\"data-rehype-pretty-code-fragment\":\"\",\"children\":[\"$\",\"pre\",null,{\"className\":\"mt-6 mb-4 overflow-x-auto rounded-lg bg-zinc-900 py-4 github-dark\",\"style\":{\"backgroundColor\":\"#24292e\"},\"tabIndex\":\"0\",\"data-language\":\"json\",\"data-theme\":\"default\",\"children\":[\"$\",\"code\",null,{\"className\":\"relative rounded border bg-zinc-300 bg-opacity-25 py-[0.2rem] px-[0.3rem] font-mono text-sm text-zinc-600\",\"data-language\":\"json\",\"data-theme\":\"default\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"{\"}]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#FDAEB7\",\"fontStyle\":\"italic\"},\"children\":\"'{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"\\\"page\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"/auth/login\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"\\\"country\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"DE\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"}': \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"5\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"  '{\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"\\\"page\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"/auth/login\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\",\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"\\\"country\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\": \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#9ECBFF\"},\"children\":\"\\\"US\\\"\"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"}': \"}],[\"$\",\"span\",null,{\"style\":{\"color\":\"#79B8FF\"},\"children\":\"2\"}]]}],\"\\n\",[\"$\",\"span\",null,{\"data-line\":\"\",\"children\":[\"$\",\"span\",null,{\"style\":{\"color\":\"#E1E4E8\"},\"children\":\"}\"}]}]]}]}]}]]}]}]]}]\n"])</script><script>self.__next_f.push([1,"5:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"moalarbi.com\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Co-founder of unkey.dev and founder of planetfall.io\"}],[\"$\",\"meta\",\"3\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"moalarbi.com\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"Co-founder of unkey.dev and founder of planetfall.io\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://moalarbi.com/\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:site_name\",\"content\":\"moalarbi.com\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:locale\",\"content\":\"en-US\"}],[\"$\",\"meta\",\"11\",{\"property\":\"og:image\",\"content\":\"https://moalarbi.com/og.png\"}],[\"$\",\"meta\",\"12\",{\"property\":\"og:image:width\",\"content\":\"1920\"}],[\"$\",\"meta\",\"13\",{\"property\":\"og:image:height\",\"content\":\"1080\"}],[\"$\",\"meta\",\"14\",{\"property\":\"og:type\",\"content\":\"website\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"16\",{\"name\":\"twitter:title\",\"content\":\"Chronark\"}],[\"$\",\"meta\",\"17\",{\"name\":\"twitter:description\",\"content\":\"Co-founder of unkey.dev and founder of planetfall.io\"}],[\"$\",\"meta\",\"18\",{\"name\":\"twitter:image\",\"content\":\"https://moalarbi.com/og.png\"}],[\"$\",\"meta\",\"19\",{\"name\":\"twitter:image:width\",\"content\":\"1920\"}],[\"$\",\"meta\",\"20\",{\"name\":\"twitter:image:height\",\"content\":\"1080\"}],[\"$\",\"link\",\"21\",{\"rel\":\"shortcut icon\",\"href\":\"/favicon.png\"}]]\n"])</script><script>self.__next_f.push([1,"a:null\n"])</script></body></html>